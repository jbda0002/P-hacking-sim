)
first=figuredata[figuredata$IndependentVariables==1]
second=figuredata[figuredata$IndependentVariables==2]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.y-figuredata$mean.x
figuredata$FPRdiff=figuredata$FPR.y-figuredata$FPR.x
Figure1C = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPRdiff,3),label=round(FPRdiff,3)), vjust=-1)+
#geom_text( aes(y=round(diff,3),label=round(diff,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Difference between false-positive rate")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = 0, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1C.csv"),sep=";")
Figure1C
## Figure 1D
# The effect of bigger sample
figuredata<-as.data.table(falsepostive[ falsepostive$OutlierExclusion=="FALSE" & falsepostive$Correlation==0.2 & falsepostive$IndependentVariables==1 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect"
& falsepostive$Type!="h1=Normal, Co=Normal",]
)
figuredata$Set <- factor(figuredata$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
figuredata$Pr<-as.numeric(figuredata$mean)
Figure1D<-ggplot(aes(x=SampleSize), data=figuredata)+
geom_line(aes( y=Pr),show.legend = FALSE,color="#000000") +
geom_point(aes( y=Pr),show.legend = FALSE,color="#000000")+
geom_line(aes( y=FPR),show.legend = FALSE,color="#FF6666") +
geom_point(aes( y=FPR),show.legend = FALSE,color="#FF6666")+
# scale_color_grey()+
facet_grid(Set~Main+Type)+
ylab("Probability")+
xlab("Sample size")+
theme_apa()+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 8, angle = 0, hjust = .5, vjust = 0, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1D.csv"),sep=";")
Figure1D
Figure1 = ggarrange(Figure1A, Figure1D, Figure1B,Figure1C,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
Figure1
ggsave(Figure1,filename = file.path(output,"Figures","Figure1.jpeg"),width = 15,height = 17)
ggsave(Figure1A,filename = file.path(output,"Figures","Figure1A.jpeg"))
ggsave(Figure1B,filename = file.path(output,"Figures","Figure1B.jpeg"))
ggsave(Figure1C,filename = file.path(output,"Figures","Figure1C.jpeg"))
ggsave(Figure1D,filename = file.path(output,"Figures","Figure1D.jpeg"))
Figure1A
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$OutlierExclusion=="FALSE" & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
ggsave(Figure1A,filename = file.path(output,"Figures","Figure1A.jpeg"),width = 6,height = 7)
ggsave(Figure1A,filename = file.path(output,"Figures","Figure1A.jpeg"),width = 6,height = 7)
ggsave(Figure1B,filename = file.path(output,"Figures","Figure1B.jpeg"),width = 6,height = 7)
ggsave(Figure1C,filename = file.path(output,"Figures","Figure1C.jpeg"),width = 6,height = 7)
ggsave(Figure1D,filename = file.path(output,"Figures","Figure1D.jpeg"),width = 6,height = 7)
Figure1B
Figure1C
Figure1D
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$OutlierExclusion=="FALSE" & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1A.csv"),sep=";")
Figure1A
## Figure 1B
# Effect of using outlier citeria, with two covariates and sample size at 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
first=figuredata[figuredata$OutlierExclusion=="TRUE"]
second=figuredata[figuredata$OutlierExclusion=="FALSE"]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.x-figuredata$mean.y
figuredata$FPRdiff=figuredata$FPR.x-figuredata$FPR.y
Figure1B = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPRdiff,3),label=round(FPRdiff,3)), vjust=-1)+
#geom_text( aes(y=round(diff,3),label=round(diff,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Difference in probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1B.csv"),sep=";")
Figure1B
## Figure 1C
# Adding an extra covariate
figuredata<-as.data.table(falsepostive[falsepostive$SampleSize==200  & falsepostive$OutlierExclusion=="FALSE" & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
)
first=figuredata[figuredata$IndependentVariables==1]
second=figuredata[figuredata$IndependentVariables==2]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.y-figuredata$mean.x
figuredata$FPRdiff=figuredata$FPR.y-figuredata$FPR.x
Figure1C = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPRdiff,3),label=round(FPRdiff,3)), vjust=-1)+
#geom_text( aes(y=round(diff,3),label=round(diff,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Difference between false-positive rate")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1C.csv"),sep=";")
Figure1C
## Figure 1D
# The effect of bigger sample
figuredata<-as.data.table(falsepostive[ falsepostive$OutlierExclusion=="FALSE" & falsepostive$Correlation==0.2 & falsepostive$IndependentVariables==1 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect"
& falsepostive$Type!="h1=Normal, Co=Normal",]
)
figuredata$Set <- factor(figuredata$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
figuredata$Pr<-as.numeric(figuredata$mean)
Figure1D<-ggplot(aes(x=SampleSize), data=figuredata)+
geom_line(aes( y=Pr),show.legend = FALSE,color="#000000") +
geom_point(aes( y=Pr),show.legend = FALSE,color="#000000")+
geom_line(aes( y=FPR),show.legend = FALSE,color="#FF6666") +
geom_point(aes( y=FPR),show.legend = FALSE,color="#FF6666")+
# scale_color_grey()+
facet_grid(Set~Main+Type)+
ylab("Probability")+
xlab("Sample size")+
theme_apa()+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1D.csv"),sep=";")
Figure1D
Figure1 = ggarrange(Figure1A, Figure1D, Figure1B,Figure1C,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
Figure1
ggsave(Figure1,filename = file.path(output,"Figures","Figure1.jpeg"),width = 15,height = 17)
ggsave(Figure1A,filename = file.path(output,"Figures","Figure1A.jpeg"),width = 6,height = 7)
ggsave(Figure1B,filename = file.path(output,"Figures","Figure1B.jpeg"),width = 6,height = 7)
ggsave(Figure1C,filename = file.path(output,"Figures","Figure1C.jpeg"),width = 6,height = 7)
ggsave(Figure1D,filename = file.path(output,"Figures","Figure1D.jpeg"),width = 6,height = 7)
##Load lib
## Set output directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
output = dirname(dirname(getwd()))
output=paste0(output,"/Result")
library(data.table)
library(ggplot2)
library(jtools)
library(ggpubr)
library(Rmisc)
##Load the data
fileplace=paste0(output,"/Files/ResultsSim.csv")
finalresults = fread(fileplace,sep=";")
## Figures for paper ##
falsepostiveFULL
##Load lib
## Set output directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
output = dirname(dirname(getwd()))
output=paste0(output,"/Result")
library(data.table)
library(ggplot2)
library(jtools)
library(ggpubr)
library(Rmisc)
library(xtable)
##Load the data
fileplace=paste0(output,"/Files/ResultsSim.csv")
finalresults = fread(fileplace,sep=";")
## Figures for paper ##
## Make the false positve data
falsepositverateData<-as.data.table(finalresults)
falsepositverateData<-falsepositverateData[falsepositverateData$Power2==1 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==1 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==1 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==1,]
falsepositverateData$rate=ifelse(falsepositverateData$f..>0,1,0)
falsepostive=falsepositverateData[,list(mean=mean(rate),FPR=mean(f..)),by=c("Main","Set","Type","SampleSize","OutlierExclusion","Correlation","IndependentVariables","DV")]
falsepostive$Main[falsepostive$Main==1]<-"Main = TRUE"
falsepostive$Main[falsepostive$Main==2]<-"Main = FALSE"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==3]<-"h1=Normal, Co=Binary"
falsepostive$Type[falsepostive$Type==4]<-"h1=Binary, Co=Normal"
falsepostive$Type[falsepostive$Type==5]<-"h1=Binary, Co=Binary Effect"
falsepostive$Type[falsepostive$Type==6]<-"h1=Normal, Co=Binary Effect"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==2]<-"FALSE"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==1]<-"TRUE"
falsepostive$Set <- factor(falsepostive$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
falsepostive$Pr<-as.numeric(falsepostive$mean)
## Figure 1A
# False-positive rate for each set with just two covariates and a sample size of 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$OutlierExclusion=="FALSE" & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1A.csv"),sep=";")
Figure1A
## Figure 1B
# Effect of using outlier citeria, with two covariates and sample size at 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
first=figuredata[figuredata$OutlierExclusion=="TRUE"]
second=figuredata[figuredata$OutlierExclusion=="FALSE"]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.x-figuredata$mean.y
figuredata$FPRdiff=figuredata$FPR.x-figuredata$FPR.y
Figure1B = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPRdiff,3),label=round(FPRdiff,3)), vjust=-1)+
#geom_text( aes(y=round(diff,3),label=round(diff,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Difference in probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1B.csv"),sep=";")
Figure1B
## Figure 1C
# Adding an extra covariate
figuredata<-as.data.table(falsepostive[falsepostive$SampleSize==200  & falsepostive$OutlierExclusion=="FALSE" & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
)
first=figuredata[figuredata$IndependentVariables==1]
second=figuredata[figuredata$IndependentVariables==2]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.y-figuredata$mean.x
figuredata$FPRdiff=figuredata$FPR.y-figuredata$FPR.x
Figure1C = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPRdiff,3),label=round(FPRdiff,3)), vjust=-1)+
#geom_text( aes(y=round(diff,3),label=round(diff,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Difference between false-positive rate")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1C.csv"),sep=";")
Figure1C
## Figure 1D
# The effect of bigger sample
figuredata<-as.data.table(falsepostive[ falsepostive$OutlierExclusion=="FALSE" & falsepostive$Correlation==0.2 & falsepostive$IndependentVariables==1 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect"
& falsepostive$Type!="h1=Normal, Co=Normal",]
)
figuredata$Set <- factor(figuredata$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
figuredata$Pr<-as.numeric(figuredata$mean)
Figure1D<-ggplot(aes(x=SampleSize), data=figuredata)+
geom_line(aes( y=Pr),show.legend = FALSE,color="#000000") +
geom_point(aes( y=Pr),show.legend = FALSE,color="#000000")+
geom_line(aes( y=FPR),show.legend = FALSE,color="#FF6666") +
geom_point(aes( y=FPR),show.legend = FALSE,color="#FF6666")+
# scale_color_grey()+
facet_grid(Set~Main+Type)+
ylab("Probability")+
xlab("Sample size")+
theme_apa()+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 10, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1D.csv"),sep=";")
Figure1D
Figure1 = ggarrange(Figure1A, Figure1D, Figure1B,Figure1C,
labels = c("A", "B", "C","D"),
ncol = 2, nrow = 2)
Figure1
ggsave(Figure1,filename = file.path(output,"Figures","Figure1.jpeg"),width = 15,height = 17)
ggsave(Figure1A,filename = file.path(output,"Figures","Figure1A.jpeg"),width = 6,height = 7)
ggsave(Figure1B,filename = file.path(output,"Figures","Figure1B.jpeg"),width = 6,height = 7)
ggsave(Figure1C,filename = file.path(output,"Figures","Figure1C.jpeg"),width = 6,height = 7)
ggsave(Figure1D,filename = file.path(output,"Figures","Figure1D.jpeg"),width = 6,height = 7)
### Using the full model set ###
resultsFullset=read.csv(paste0(output,"/Resultfile/resultsFullSet.csv"),sep=",")
falsepositverateDataFull<-as.data.table(resultsFullset)
falsepositverateDataFull$rate=ifelse(falsepositverateDataFull$f..>0,1,0)
output
resultsFullset=read.csv(paste0(output,"/Files/resultsFullSet.csv"),sep=",")
falsepositverateDataFull<-as.data.table(resultsFullset)
falsepositverateDataFull$rate=ifelse(falsepositverateDataFull$f..>0,1,0)
falsepostiveFULL=falsepositverateDataFull[,list(meanF=mean(rate),meanD=mean(f..)),by=c("Main","Type","SampleSize","OutlierExclusion","Correlation","IndependentVariables")]
View(falsepositverateDataFull)
resultsFullset=fread(paste0(output,"/Files/resultsFullSet.csv"),sep=";")
falsepositverateDataFull<-as.data.table(resultsFullset)
falsepositverateDataFull$rate=ifelse(falsepositverateDataFull$f..>0,1,0)
falsepostiveFULL=falsepositverateDataFull[,list(meanF=mean(rate),meanD=mean(f..)),by=c("Main","Type","SampleSize","OutlierExclusion","Correlation","IndependentVariables")]
falsepostiveFULL
falsepostiveFULL=falsepositverateDataFull[,list(FPP=mean(rate),FPR=mean(f..)),by=c("Main","Type","SampleSize","OutlierExclusion","Correlation","IndependentVariables")]
falsepostiveFULL
falsepostiveFULL$Main=ifelse(falsepositverateDataFull$Main==1,"TRUE","FALSE")
falsepostiveFULL$Main=ifelse(falsepostiveFULL$Main==1,"TRUE","FALSE")
falsepostiveFULL$Type=ifelse(falsepostiveFULL$Type==1,"Normal","Binomial")
falsepostiveFULL
falsepostiveFULL=falsepositverateDataFull[,list(FPP=mean(rate),FPR=mean(f..)),by=c("Main","Type","IndependentVariables")]
falsepostiveFULL$Main=ifelse(falsepostiveFULL$Main==1,"TRUE","FALSE")
falsepostiveFULL$Type=ifelse(falsepostiveFULL$Type==1,"Normal","Binomial")
falsepostiveFULL
falsepostiveFULL=falsepositverateDataFull[,list(FPP=mean(rate),FPR=mean(f..)),by=c("Main","Type")]
falsepostiveFULL$Main=ifelse(falsepostiveFULL$Main==1,"TRUE","FALSE")
falsepostiveFULL$Type=ifelse(falsepostiveFULL$Type==1,"Normal","Binomial")
falsepostiveFULL
print(xtable(TableModelsFalse,digits = 0, type = "latex")
, caption = "", include.rownames=FALSE, file = "ModelNumberFalse.tex")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
## Number of covarietes
covarites = c(2,3,4,5,6)
#Main = F
#Ma
Ma = function(n){
number = 2^n
number
}
## CCI
CCI = function(n){
number = 2^(n*(n-1)/2-1)
number
}
## HCI
HCI = function(n){
number = 2^n-1
number
}
## Ma + CCI
Ma_CCI = function(n){
number = (2^n-1)*(2^(n*(n-1)/2)-1)
number
}
## Ma + HCI
Ma_HCI = function(n){
number = (2^n-1)^2
number
}
## HCI + CCI
HCI_CCI = function(n){
number = (2^n-1)*(2^(n*(n-1)/2)-1)
number
}
## Ma + HCI + CCI
Ma_HCI_CCI = function(n){
number = (2^n-1)^2*(2^(n*(n-1)/2)-1)
number
}
TableModelsFalse = NULL
## Make the table
for (i in covarites) {
number_of_models=c(Ma(i),HCI(i),CCI(i),Ma_HCI(i),Ma_CCI(i),HCI_CCI(i),Ma_HCI_CCI(i))
fullset=sum(number_of_models)
set=c(i,number_of_models,fullset)
TableModelsFalse=rbind(TableModelsFalse,set)
}
TableModelsFalse=as.data.frame(TableModelsFalse)
names(TableModelsFalse)=c("Number of covariates" , "Ma" ,"HCI","CCI", "Ma+HCI" , "Ma+CCI","HCI+CCI", "Ma+HCI+CCI", "Number of models")
## Main = T
#Main = F
#Ma
Ma = function(n){
number = 2^n
number
}
## Ma + CCI
Ma_CCI = function(n){
number=NULL
for (i in 2:n) {
number=c(number,choose(n,i)*(2^(i*(i-1)/2)-1))
}
number = sum(number)
number
}
## Ma + HCI
Ma_HCI = function(n){
number=NULL
for (i in 1:n) {
number=c(number,choose(n,i)*(2^(i)-1))
}
number = sum(number)
number
}
## Ma + HCI + CCI
Ma_HCI_CCI = function(n){
number=NULL
for (i in 1:n) {
number=c(number,choose(n,i)*(2^(i*(i-1)/2)-1)*(2^i-1))
}
number = sum(number)
number
}
TableModelsTrue = NULL
## Make the table
for (i in covarites) {
number_of_models=c(Ma(i),Ma_HCI(i),Ma_CCI(i),Ma_HCI_CCI(i))
fullset=sum(number_of_models)
set=c(i,number_of_models,fullset)
TableModelsTrue=rbind(TableModelsTrue,set)
}
TableModelsTrue=as.data.frame(TableModelsTrue)
rownames(TableModelsTrue)=NULL
names(TableModelsTrue)=c("Number of covariates", "Ma","Ma+HCI", "Ma+CCI", "Ma+HCI+CCI", "Number of models")
## Save tables
library(xtable)
print(xtable(TableModelsTrue,digits = 0, type = "latex",
auto=T),include.rownames=FALSE, file = "ModelNumberTrue.tex")
print(xtable(TableModelsFalse,digits = 0, type = "latex")
, caption = "", include.rownames=FALSE, file = "ModelNumberFalse.tex")
print(xtable(TableModelsFalse,digits = 0, type = "latex")
, caption = "test", include.rownames=FALSE, file = "ModelNumberFalse.tex")
print(xtable(TableModelsTrue,digits = 0, type = "latex",
caption ="test" ),include.rownames=FALSE, file = "ModelNumberTrue.tex")
print(xtable(TableModelsTrue,digits = 0, type = "latex",
caption ="" ),include.rownames=FALSE, file = "ModelNumberTrue.tex")
print(xtable(TableModelsTrue,digits = 0, type = "latex",
caption ="" ),include.rownames=FALSE, file = "ModelNumberTrue.tex")
print(xtable(TableModelsFalse,digits = 0, type = "latex",caption =""), include.rownames=FALSE, file = "ModelNumberFalse.tex")
