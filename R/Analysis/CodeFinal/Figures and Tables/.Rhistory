falsepostive$Main[falsepostive$Main==1]<-"Main = TRUE"
falsepostive$Main[falsepostive$Main==2]<-"Main = FALSE"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==3]<-"h1=Normal, Co=Binary"
falsepostive$Type[falsepostive$Type==4]<-"h1=Binary, Co=Normal"
falsepostive$Type[falsepostive$Type==5]<-"h1=Binary, Co=Binary Effect"
falsepostive$Type[falsepostive$Type==6]<-"h1=Normal, Co=Binary Effect"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==2]<-"FALSE"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==1]<-"TRUE"
falsepostive$Set <- factor(falsepostive$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
falsepostive$Pr<-as.numeric(falsepostive$mean)
## Figure 1A
# False-positive rate for each set with just two covariates and a sample size of 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$OutlierExclusion=="FALSE" & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR), stat = "identity",position="dodge", fill = "#FF6666")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR), stat = "identity",position="dodge", fill = FPR)+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, color = "#FF6666"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, color = "red"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, color = "#FF6666"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, color = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, color = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, color = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, color = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_colour_manual(values=c("red","#FF6666"))+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_colour_manual(values=c("red","#FF6666"))+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("red","#FF6666"))+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "#FF6666"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("red","#FF6666"))+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "#FF6666"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
#scale_fill_manual(values=c("red","#FF6666"))+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#999999", "#E69F00"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#999999", "#FF6666"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#FF6666", "red"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#FF6666", "#FF9999"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#999999", "#FF6666"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(values=c("#999999", "black"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_manual(breaks = c("FPP", "FPR"),values=c("#999999", "black"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_brewer(palette="Dark2")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
scale_fill_brewer(palette="Dark")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
scale_fill_brewer(values="red")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_brewer(values="black")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
scale_fill_brewer("red")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_brewer("black")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
scale_fill_manual(c("red","black"))+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("red","black"))+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("black","red
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1A.csv"),sep=";")
Figure1A
## Figure 1B
# Effect of using outlier citeria, with two covariates and sample size at 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
first=figuredata[figuredata$OutlierExclusion=="TRUE"]
second=figuredata[figuredata$OutlierExclusion=="FALSE"]
figuredata <- merge(first,second, by=c("Main","Set","Type"),all=T, allow.cartesian=TRUE)
figuredata$diff=figuredata$mean.x-figuredata$mean.y
figuredata$FPRdiff=figuredata$FPR.x-figuredata$FPR.y
Figure1B = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=diff), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPRdiff), stat = "identity",position="dodge", fill = "#FF6666")+
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("black","red"))
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("black","red"))+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
##Load lib
## Set output directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
output = dirname(dirname(getwd()))
output=paste0(output,"/Result")
library(data.table)
library(ggplot2)
library(jtools)
library(ggpubr)
library(Rmisc)
library(xtable)
##Load the data
fileplace=paste0(output,"/Files/ResultsSim.csv")
finalresults = fread(fileplace,sep=";")
## Figures for paper ##
## Make the false positve data
falsepositverateData<-as.data.table(finalresults)
falsepositverateData<-falsepositverateData[falsepositverateData$Power2==1 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==1 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==1 & falsepositverateData$Power13==2|
falsepositverateData$Power2==2 & falsepositverateData$Power3==2 & falsepositverateData$Power12==2 & falsepositverateData$Power13==1,]
falsepositverateData$rate=ifelse(falsepositverateData$f..>0,1,0)
falsepostive=falsepositverateData[,list(mean=mean(rate),FPR=mean(f..)),by=c("Main","Set","Type","SampleSize","OutlierExclusion","Correlation","IndependentVariables","DV")]
falsepostive$Main[falsepostive$Main==1]<-"Main = TRUE"
falsepostive$Main[falsepostive$Main==2]<-"Main = FALSE"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==1]<-"h1=Normal, Co=Normal"
falsepostive$Type[falsepostive$Type==2]<-"h1=Binary, Co=Binary"
falsepostive$Type[falsepostive$Type==3]<-"h1=Normal, Co=Binary"
falsepostive$Type[falsepostive$Type==4]<-"h1=Binary, Co=Normal"
falsepostive$Type[falsepostive$Type==5]<-"h1=Binary, Co=Binary Effect"
falsepostive$Type[falsepostive$Type==6]<-"h1=Normal, Co=Binary Effect"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==2]<-"FALSE"
falsepostive$OutlierExclusion[falsepostive$OutlierExclusion==1]<-"TRUE"
falsepostive$Set <- factor(falsepostive$Set,levels = c("Ma", "HCI", "CCI", "Ma + HCI","Ma + CCI","HCI + CCI","Ma + HCI + CCI"))
falsepostive$Pr<-as.numeric(falsepostive$mean)
## Figure 1A
# False-positive rate for each set with just two covariates and a sample size of 200
figuredata<-falsepostive[falsepostive$SampleSize==200 & falsepostive$OutlierExclusion=="FALSE" & falsepostive$IndependentVariables==1 & falsepostive$Correlation==0.2 & falsepostive$DV==1
& falsepostive$Type!="h1=Normal, Co=Binary" & falsepostive$Type!="h1=Binary, Co=Normal"
& falsepostive$Type!="h1=Binary, Co=Binary Effect" & falsepostive$Type!="h1=Normal, Co=Binary Effect",]
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("black","red"))+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("#FF6666","red"))+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
Figure1A = ggplot(figuredata,aes(x=Set))+
geom_bar(aes(x=Set,y=Pr, fill = "FPP"), stat = "identity",position="dodge")+
geom_bar(aes(x=Set,y=FPR, fill = "FPR"), stat = "identity",position="dodge")+
scale_fill_manual(values=c("black","red"))+
#geom_text( aes(y=round(FPR,3),label=round(FPR,3)), vjust=-2)+
#geom_text( aes(y=round(Pr,3),label=round(Pr,3)), vjust=-1)+
facet_grid(Type~Main)+
theme_apa()+
xlab("Model set")+
ylab("Probability")+
theme(axis.text.x = element_text(color = "grey20", size = 10, angle = 65, hjust = .5, vjust = .5, face = "plain"),
axis.text.y = element_text(color = "grey20", size = 14, angle = 0, hjust = 1, vjust = 0, face = "plain"),
axis.title.x = element_text(color = "grey20", size = 14, angle = 0, hjust = .5, vjust = 0, face = "plain"),
axis.title.y = element_text(color = "grey20", size = 14, angle = 90, hjust = .5, vjust = .5, face = "plain"),
strip.text.x = element_text(color = "grey20", size = 10, angle = 0, hjust = .5, vjust = .5, face = "plain"),
strip.text.y = element_text(color = "grey20", size = 10, angle = 90, hjust = .5, vjust = .5, face = "plain"))
Figure1A
##Save data
fwrite(figuredata,paste0(output,"/Files/figuredata1A.csv"),sep=";")
